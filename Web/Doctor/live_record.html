<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta
          name="viewport"
          content="width=device-width, initial-scale=1.0, user-scalable=0"
  />
  <link
          rel="shortcut icon"
          type="image/x-icon"
          href="assets/img/favicon.ico"
  />
  <title>Doctor</title>
  <link
          href="https://fonts.googleapis.com/icon?family=Material+Icons"
          rel="stylesheet"
  />
  <link
          rel="stylesheet"
          type="text/css"
          href="assets/css/bootstrap.min.css"
  />
  <link
          rel="stylesheet"
          type="text/css"
          href="assets/css/font-awesome.min.css"
  />
  <link rel="stylesheet" type="text/css" href="assets/css/style.css" />
</head>

<body>
<div class="main-wrapper">
  <div class="header">
    <div class="header-left">
      <a href="index.html" class="logo">
        <img src="assets/img/logo.png" width="35" height="35" alt="" />
        <span>UnisalHeart</span>
      </a>
    </div>
    <a id="toggle_btn" href="javascript:void(0);"
    ><i class="fa fa-bars"></i
    ></a>
    <a id="mobile_btn" class="mobile_btn float-left" href="#sidebar"
    ><i class="fa fa-bars"></i
    ></a>
    <ul class="nav user-menu float-right">
      <li class="nav-item dropdown has-arrow">
        <a
                href="#"
                class="dropdown-toggle nav-link user-link"
                data-toggle="dropdown"
        >
              <span class="user-img">
                <img
                        class="rounded-circle"
                        src="assets/img/profile.JPG"
                        width="24"
                        alt="Admin"
                />
                <span class="status online"></span>
              </span>
          <span>20075337</span>
        </a>
        <div class="dropdown-menu">
          <a class="dropdown-item" href="#">My Profile</a>
          <a class="dropdown-item" href="#">Edit Profile</a>
          <a class="dropdown-item" href="#">Settings</a>
          <a class="dropdown-item" href="login.html">Logout</a>
        </div>
      </li>
    </ul>
    <div class="dropdown mobile-user-menu float-right">
      <a
              href="#"
              class="dropdown-toggle"
              data-toggle="dropdown"
              aria-expanded="false"
      ><i class="fa fa-ellipsis-v"></i
      ></a>
      <div class="dropdown-menu dropdown-menu-right">
        <a class="dropdown-item" href="patient_profile.html">My Profile</a>
        <a class="dropdown-item" href="edit-profile.html">Edit Profile</a>
        <a class="dropdown-item" href="settings.html">Settings</a>
        <a class="dropdown-item" href="login.html">Logout</a>
      </div>
    </div>
  </div>
  <div class="sidebar" id="sidebar">
    <div class="sidebar-inner slimscroll">
      <div id="sidebar-menu" class="sidebar-menu">
        <ul>
          <li class="menu-title">Patient Monitoring</li>
          <li class="inactive">
            <a href="patient_profile.html"
            ><i class="fa fa-dashboard"></i> <span>Patient Profile</span></a
            >
          </li>
          <li class="submenu">
            <a href="#"
            ><i class="fa fa-wheelchair"></i>
              <span> Patient's Records</span>
              <span class="menu-arrow"></span
              ></a>
            <ul style="display: none">
              <li><a href="#">Previous Record</a></li>
              <li><a href="live_record.html">Live Record</a></li>
              <li><a href="#">New Record</a></li>
            </ul>
          </li>
          <li class="submenu">
            <a href="#"
            ><i class="fa fa-laptop"></i> <span>Device</span>
              <span class="menu-arrow"></span
              ></a>
            <ul style="display: none">
              <li>
                <a href="patient_device.html">Check Device Of Patient</a>
              </li>
            </ul>
          </li>
          <li class="submenu">
            <a href="calender_1.html"
            ><i class="fa fa-calendar"></i> <span>Calender</span>
              <span class="menu-arrow"></span
              ></a>
            <ul style="display: none">
              <li>
                <a href="calender_1.html">Event Notice On Calender</a>
              </li>
            </ul>
          </li>
          <li class="submenu">
            <a href="#"
            ><i class="fa fa-comments"></i> <span>Messaging System</span
            ><span class="menu-arrow"></span
            ></a>
            <ul style="display: none">
              <li>
                <a href="notification_alert.html">Notification Alert</a>
              </li>
              <li>
                <a href="live_record.html">Admin Instruction</a>
              </li>
              <li>
                <a href="sent_to_admin_user.html">Send to Admin/Users</a>
              </li>
            </ul>
          </li>
          <li class="inactive">
            <a href="records.html"
            ><i class="fa fa-arrow-left"></i> <span>Back to List</span></a
            >
          </li>
        </ul>
      </div>
    </div>
  </div>
  <div class="page-wrapper">
    <div class="main-body">
      <div class="row gutters-sm">
        <div class="col-md-3 mb-3">
          <div class="card">
            <div class="card-body">
              <div class="d-flex flex-column align-items-center text-center">
                <span class="user-img">
                  <img
                          src="https://bootdey.com/img/Content/avatar/avatar8.png"
                          alt="Admin"
                          class="rounded-circle"
                          width="150"
                  />
                  <span class="status online"></span>
                </span>
                <div class="mt-3">
                  <h4>Jennifer Robinson</h4>
                  <!-- <p class="text-secondary mb-1">Full Stack Developer</p> -->
                  <p class="text-muted font-size-sm">Lecce, LE, Italy</p>
                  <button class="btn btn-outline-primary">Call</button>
                  <button class="btn btn-outline-primary">Messages</button>
                </div>
              </div>
            </div>
          </div>
          <div class="card mt-3" style="scroll-behavior: smooth">
            <ul class="list-group list-group-flush">
              <li
                      class="list-group-item d-flex justify-content-between align-items-center flex-wrap"
              >
                <h6 class="mb-0">Patient ID</h6>
                <span class="text-secondary">17021215</span>
              </li>
              <li
                      class="list-group-item d-flex justify-content-between align-items-center flex-wrap"
              >
                <h6 class="mb-0">Age</h6>
                <span class="text-secondary">70</span>
              </li>
              <li
                      class="list-group-item d-flex justify-content-between align-items-center flex-wrap"
              >
                <h6 class="mb-0">Email</h6>
                <span class="text-secondary">abc@example.com</span>
              </li>
              <li
                      class="list-group-item d-flex justify-content-between align-items-center flex-wrap"
              >
                <h6 class="mb-0">Phone</h6>
                <span class="text-secondary">+39 123 456 1234</span>
              </li>
              <li
                      class="list-group-item d-flex justify-content-between align-items-center flex-wrap"
              >
                <h6 class="mb-0">Last check</h6>
                <span class="text-secondary">2022-06-13 15:08</span>
              </li>
            </ul>
          </div>
        </div>
        <div class="col-md-9 mb-3">
          <div class="row gutters-sm">
            <div class="col-sm-4 mb-2">
              <div class="card h-100">
                <div class="card-body">
                  <h4 class="card-title">HF Prediction</h4>
                  <div class="center" id="hf-prediction-chart" style="width: 100%; max-width: 500px"></div>
                </div>
              </div>
            </div>
            <div class="col-sm-4 mb-2">
              <div class="card h-100">
                <div class="card-body">
                  <h4 class="card-title">Resting BP</h4>
                  <div class="center" id="resting-bp-chart" style="width: 100%; max-width: 600px"></div>
                </div>
              </div>
            </div>
            <div class="col-sm-4 mb-2">
              <div class="card h-100">
                <div class="card-body">
                  <h4 class="card-title">Cholesterol</h4>
                  <div class="center" id="cholesterol-chart" style="width: 100%; max-width: 600px;"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="row gutters-sm mb-3">
            <div class="col-sm-4 mb-3">
              <div class="card h-100">
                <div class="card-body">
                  <h4 class="card-title">Fasting BS</h4>
                  <div class="center" id="fasting-bs-chart" style="width: 100%; max-width: 600px;"></div>
                </div>
              </div>
            </div>
            <div class="col-sm-4 mb-3">
              <div class="card h-100">
                <div class="card-body">
                  <h4 class="card-title">Resting ECG</h4>
                  <div class="center" id="resting-ecg-chart" style="width: 100%; max-width: 600px;"></div>
                </div>
              </div>
            </div>
            <div class="col-sm-4 mb-3">
              <div class="card h-100">
                <div class="card-body">
                  <h4 class="card-title">Heart Rate</h4>
                  <div class="center" id="pulse-rate-chart" style="width: 100%; max-width: 600px;"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="row gutters-sm">
            <div class="col-sm-12 mb-2">
              <div class="card h-100">
                <div class="card-body">
                  <h4 class="card-title">Overview</h4>
                  <div class="center" id="overview-chart" style="width: 100%;"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>
<div class="sidebar-overlay" data-reff=""></div>
<script>
  var socketExample = new WebSocket("ws://localhost:3001");

  socketExample.onopen = function (event) {
    socketExample.send("Text to be sent to the server!");
  };
</script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script>
  // load current chart package
  google.charts.load("current", {
    packages: ["corechart", "line"]
  });
  // set callback function when api loaded
  google.charts.setOnLoadCallback(drawChart);
  function drawChart() {
    // create data object with default value
    let data = google.visualization.arrayToDataTable([
      ["Second", "Resting BP", "Cholesterol", "Fasting BS", "Resting ECG", "Max HR"],
      [0, 0, 0, 0, 0, 0]
    ]);
    // create options object with titles, colors, etc.
    let options = {
      hAxis: {
        title: "Time (3x)"
      },
      vAxis: {
        title: "Value"
      },
      animation:{
        duration: 1000,
        easing: 'out',
      },
      //curveType: 'function',
      //smoothline: 'true',
      legend: { position: 'top' }
    };
    // draw chart on load
    let chart = new google.visualization.LineChart(
            document.getElementById("overview-chart")
    );
    chart.draw(data, options);
    // interval for adding new data every 250ms
    let index = 0;
    setInterval(function() {
      // instead of this random, you can make an ajax call for the current cpu usage or what ever data you want to display
      let random1 = Math.floor(Math.random() * 100 + 30);
      let random2 = parseFloat((Math.random() * 20 + 80).toFixed(2));
      let random3 = parseFloat((Math.random() * 10 + 35).toFixed(1));
      let random4 = parseFloat((Math.random() * 10 + 35).toFixed(1));
      let random5 = parseFloat((Math.random() * 10 + 35).toFixed(1));
      data.addRow(
              [index, random1, random2, random3, random4 ,random5]
      );
      chart.draw(data, options);
      index++;
    }, 3000);
  }
</script>
<script type="text/javascript">
  google.charts.load('current', {'packages':['gauge']});
  google.charts.setOnLoadCallback(drawChart);

  function drawChart() {
    var hf_prediction_data = google.visualization.arrayToDataTable([
      ['Label', 'Value'],
      ['HF', 0]
    ]);
    var resting_bp_data = google.visualization.arrayToDataTable([
      ['Label', 'Value'],
      ['mmHg', 0]
    ]);
    var cholesterol_data = google.visualization.arrayToDataTable([
      ['Label', 'Value'],
      ['mg/dL', 0]
    ]);
    var fasting_bs_data = google.visualization.arrayToDataTable([
      ['Label', 'Value'],
      ['mg/dL', 60]
    ]);
    var resting_ecg_data = google.visualization.arrayToDataTable([
      ['Label', 'Value'],
      ['Type', 0]
    ]);
    var pulse_rate_data = google.visualization.arrayToDataTable([
      ['Label', 'Value'],
      ['BPM', 60]
    ]);

    var options = [
      {
        min: 0, max: 1,
        width: 600, height: 180,
        redFrom: 0.5, redTo: 1,
        greenFrom: 0.5, greenTo: 1,
        minorTicks: 5
      },
      {
        min: 0, max: 200,
        width: 600, height: 180,
        redFrom: 0, redTo: 110,
        greenFrom: 110, greenTo: 150,
        yellowFrom:150, yellowTo: 200,
        minorTicks: 5
      },
      {
        min: 0, max: 603,
        width: 600, height: 180,
        redFrom: 400, redTo: 603,
        yellowFrom:200, yellowTo: 400,
        greenFrom: 0, greenTo: 200,
        minorTicks: 5
      },
      {
        min: 60, max: 200,
        width: 600, height: 180,
        redFrom: 120, redTo: 200,
        yellowFrom:60, yellowTo: 80,
        greenFrom: 80, greenTo: 120,
        minorTicks: 5
      },
      {
        min: 0, max: 3,
        width: 600, height: 180,
        redFrom: 2, redTo: 3,
        yellowFrom:1, yellowTo: 2,
        greenFrom: 0, greenTo: 1,
        minorTicks: 5
      },
      {
        min: 60, max: 200,
        width: 600, height: 180,
        redFrom: 60, redTo: 90,
        yellowFrom:90, yellowTo: 150,
        greenFrom: 150, greenTo: 200,
        minorTicks: 5
      },
    ];

    var hf_prediction = new google.visualization.Gauge(document.getElementById('hf-prediction-chart'));
    var resting_bp = new google.visualization.Gauge(document.getElementById('resting-bp-chart'));
    var cholesterol = new google.visualization.Gauge(document.getElementById('cholesterol-chart'));
    var fasting_bs = new google.visualization.Gauge(document.getElementById('fasting-bs-chart'));
    var resting_ecg = new google.visualization.Gauge(document.getElementById('resting-ecg-chart'));
    var pulse_rate = new google.visualization.Gauge(document.getElementById('pulse-rate-chart'));

    hf_prediction.draw(hf_prediction_data, options[0]);
    resting_bp.draw(resting_bp_data, options[1]);
    cholesterol.draw(cholesterol_data, options[2]);
    fasting_bs.draw(fasting_bs_data, options[3]);
    resting_ecg.draw(resting_ecg_data, options[4]);
    pulse_rate.draw(pulse_rate_data, options[5]);


    socketExample.onmessage = function (event) {
      const object = JSON.parse(event.data);
      console.log('Websocket received: ', object);

      // hf_prediction_data.setValue(0, 1, object.predicted);
      hf_prediction_data.setValue(0, 1, (Math.random()>=0.5)? 1 : 0);
      resting_bp_data.setValue(0, 1, object.restingBP);
      cholesterol_data.setValue(0, 1, object.cholesterol);
      fasting_bs_data.setValue(0, 1, object.fastingBS);
      resting_ecg_data.setValue(0, 1, object.restingECG);
      pulse_rate_data.setValue(0, 1, object.MaxHR);

      hf_prediction.draw(hf_prediction_data, options[0]);
      resting_bp.draw(resting_bp_data, options[1]);
      cholesterol.draw(cholesterol_data, options[2]);
      fasting_bs.draw(fasting_bs_data, options[3]);
      resting_ecg.draw(resting_ecg_data, options[4]);
      pulse_rate.draw(pulse_rate_data, options[5]);
    };
  }
</script>
<script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ"
        crossorigin="anonymous"
></script>
<script src="assets/js/jquery-3.2.1.min.js"></script>
<script src="assets/js/popper.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/jquery.slimscroll.js"></script>
<script src="assets/js/Chart.bundle.js"></script>
<script src="assets/js/chart.js"></script>
<script src="assets/js/app.js"></script>
</body>
</html>
